COPY    START   1000		COPY FILE FROM INPUT TO OUTPUT
START
1000
1000

FIRST   STL     RETADR		SAVE RETURN ADDRESS
14
1000
RETADR

CLOOP   JSUB    RDREC		READ INPUT RECORD
48
1003
RDREC

		LDA		LENGTH		TEST FOR EOF (LENGTH = 0)
0
1006
LENGTH

		COMP    ZERO
28
1009
ZERO

		JEQ     ENDFIL		E14 IN HEXXIT IF EOF FOUND
30
100c
ENDFIL

		JSUB	WRREC		WRITE OUTPUT RECORD
48
100f
WRREC

		J       CLOOP		LOOP
3c
1012
CLOOP

ENDFIL  LDA     EOF			INSERT END OF FILE MARKER
0
1015
EOF

		STA     BUFFER
c
1018
BUFFER

		LDA     THREE		SET LENGTH = 3
0
101b
THREE

		STA     LENGTH
c
101e
LENGTH

		JSUB    WRREC		WRITE EOF
48
1021
WRREC

		LDL     RETADR		GET RETURN ADDRESS
8
1024
RETADR

		RSUB             	RETURN TO CALLER
4c
1027
RETURN

EOF     BYTE    C'EOF'
BYTE
102a
C'EOF'

THREE   WORD    3
WORD
102d
3

ZERO    WORD    0
WORD
1030
0

RETADR  RESW    1
RESW
1033
1

LENGTH  RESW    1			LENGTH OF RECORD
RESW
1036
1

BUFFER  RESB    4096		4096-BYTE BUFFER AREA
RESB
1039
4096

RDREC   LDX     ZERO		CLEAR LOOP COUNTER
4
2039
ZERO

		LDA     ZERO		CLEAR A TO ZERO
0
203c
ZERO

RLOOP   TD      INPUT		TEST INPUT DEVICE
e0
203f
INPUT

		JEQ     RLOOP		LOOP UNTIL READY
30
2042
RLOOP

		RD      INPUT		READ CHARACTER INTO REGISTAR A
d8
2045
INPUT

		COMP    ZERO		TEST FOR END OF RECORD (X'00')
28
2048
ZERO

		JEQ     EXIT		EXIT LOOP IF EOF
30
204b
EXIT

		STCH    BUFFER,X	STORE CHARCTER IN BUFFER
54
204e
BUFFER,X

		TIX     MAXLEN		LOOP UNLESS MAX LENGTH
2c
2051
MAXLEN

		JLT     RLOOP	  	HAS BEEN REACHED
38
2054
RLOOP

EXIT    STX     LENGTH		SAVE RECORD LENGTH
10
2057
LENGTH

		RSUB               	RETURN TO CALLER
4c
205a
RETURN

INPUT   BYTE    X'F1'		CODE FOR INPUT DEVICE
BYTE
205d
X'F1'

MAXLEN	WORD	4096
WORD
205e
4096

WRREC   LDX    ZERO			CLEAR LOOP COUNTER
4
2061
ZERO

WLOOP   TD     OUTPUT		TEST OUTPUT DEVICE
e0
2064
OUTPUT

		JEQ    WLOOP		LOOP UNTIL READY
30
2067
WLOOP

		LDCH   BUFFER,X	   	GET CHARCTER FROM BUFFER
50
206a
BUFFER,X

		WD     OUTPUT		WRITE CHARACTER
dc
206d
OUTPUT

		TIX    LENGTH		LOOP UNTIL ALL CHARACTERS
2c
2070
LENGTH

		JLT    WLOOP	  	HAVE BEEN WRITTEN
38
2073
WLOOP

		RSUB               	RETURN TO CALLER
4c
2076
RETURN

OUTPUT  BYTE   X'05'		CODE FOR OUTPUT DEVICE
BYTE
2079
X'05'

		END    FIRST
END
207a
FIRST

